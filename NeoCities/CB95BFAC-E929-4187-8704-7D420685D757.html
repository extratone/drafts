<!DOCTYPE html>
<html dir="auto">

<head>
  <title>Using The ed(1) Text Editor</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    @charset "utf-8";

    :root {
      --main-bg-color: #000056;
      --main-color: #ffe8bd;
      --alternate-bg-color: #1c0021;
      --alternate-color: #fff4e6;
      --main-border-color: #f43f32;
        --link-color: #36fd63;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --main-bg-color: #fff4e6;
        --main-color: #00006b;
        --alternate-bg-color: #fffdeb;
        --alternate-color: #1c0021;
        --main-border-color: #f43f32;
          --link-color: #ff0000;
      }
    }

    html {
      font-size: 100%;
      font-family: -apple-system, BlinkMacSystemFont, "helvetica neue", helvetica, roboto, noto, "segoe ui", arial, sans-serif;
      line-height: 1.4;
    }

    body {
      margin: 0;
      padding: 1em;
      background-color: var(--main-bg-color);
      color: var(--main-color);
    }

    @media (max-device-width: 480px) {}

    @media (min-device-width: 481px) {
      body {
        margin: auto;
        max-width: 600px;
      }
    }

    blockquote {
      font-style: italic;
      margin: 1.5em 2em;
      padding: 1em;
      background-color: var(--alternate-bg-color);
      color: var(--alternate-color);
    }

    a {
      color: var(--link-color);
    }
    pre {
      display: block;
      overflow: scroll;
      width: 100%;
      background-color: var(--alternate-bg-color);
      padding: .5em 1em;
      margin: 1em 0;
    }

    code {
      background-color: var(--alternate-bg-color);
      color: var(--alternate-color);
      font-family: Menlo, Courier, sans-serif;
      padding: 2px 3px;
    }

    table {
      margin: 1.5em 0;
      border: 1px solid var(--main-border-color);
      border-collapse: collapse;
    }

    th {
      padding: .25em .5em;
      background: var(--alternate-bg-color);
      border: 1px solid var(--main-border-color);
    }

    td {
      padding: .25em .5em;
      border: 1px solid var(--main-border-color);
    }

    img {
      max-width: 90%;
    }
  </style>
</head>

<body>
  <h1>Using The ed(1) Text Editor</h1>

<ul>
<li><a href="https://elly.town/d/blog/2015-10-03-ed-tutorial.txt">Ellyâ€™s Guide</a></li>
</ul>

<h1>Getting Started</h1>

<p>There&#8217;s an old joke you&#8217;ve probably heard: &#8220;ed is the standard unix text
editor&#8221;, which is kind of a joke third-party position in the editor war. If
you&#8217;ve ever gotten curious and run ed, probably something like this happened.
In this transcript, as in all those below, lines starting with &#8216;$&#8217; are typed
into the shell, lines starting with &#8216;%&#8217; are typed into ed, and lines with no
prefix are emitted by ed.</p>

<p>$ ed
% help
?
% ?
?
% quit
?
% <sup>C</sup>
?
% <sup>D</sup>
$ rm /bin/ed</p>

<p>You&#8217;ll notice that ed is extremely terse. It comes from the bad old days when
each character of output had to come through a clunking line printer, so ed
generally doesn&#8217;t say anything it doesn&#8217;t have to. Fortunately, ed has a
&#8216;helpful&#8217; mode, which you can turn on by typing &#8216;H&#8217;:</p>

<p>$ ed
% H
% help
?
invalid command suffix</p>

<p>Ok, so it could be more helpful, but it&#8217;s better than just &#8216;?&#8217; at least.</p>

<h1>What is ed, anyway?</h1>

<p>Like other editors, ed is oriented around editing &#8220;buffers&#8221;, which might be
backed by files or might just be kept in memory. At any given time, ed has only
one buffer - there&#8217;s no support for editing multiple documents simultaneously or
anything similar.</p>

<p>Most editors are &#8220;visual editors&#8221;, in which the editor always displays part of
the contents of the buffer, and you can make edits directly to the displayed
text. Some well-known visual editors are emacs and vim (which is actually a
distant descendant of ed). In contrast, ed is a &#8220;line editor&#8221;, in which the
buffer isn&#8217;t continuously displayed, and you edit the buffer by typing commands
that manipulate the text in the buffer. For example, you might type a command
for &#8220;delete the first four characters of line 3&#8221;, and the editor would carry
that out without displaying the actual text at any point. This makes ed quite
friendly for low-bandwidth or low-resource systems.</p>

<h1>Addressing</h1>

<p>So, let&#8217;s go about getting to grips with ed a bit. Since ed is a line editor,
every ed command is tagged, either implicitly or explicitly, with which lines
it&#8217;s supposed to operate on. You can address lines a bunch of ways but the most
common ways are:</p>

<ul>
<li>explicit line numbers, like &#8220;3&#8221; or &#8220;1,5&#8221;. Note that &#8220;0&#8221; is before the first
line and the first line is &#8220;1&#8221;</li>
<li>the last line, called &#8220;$&#8221;</li>
<li>the current line, called &#8220;.&#8221;</li>
<li>the next line matching a regex re, called /re/, like &#8220;/[0&#8211;3]/&#8221;</li>
</ul>

<p>Some commands implicitly operate on &#8220;.&#8221; if no line number is given.</p>

<h1>Adding Text</h1>

<p>Each command in ed needs either zero addresses, for commands that affect the
whole file, one address for commands that affect a single line, or two addresses
for commands that affect a range of lines. Commands that take a line range can
by given only one address, in which case the range is just that line. Here are
some of the basic commands:</p>

<ul>
<li>i: takes one address. Starts inserting text before the addressed line.</li>
<li>a: takes one address. Starts inserting text after the addressed line.</li>
<li>n: takes two addresses. Prints the addressed lines, with their line numbers.</li>
</ul>

<p>The i and a commands enter &#8220;insert mode&#8221;, in which typed text is added to the
buffer instead of being treated as a command - this feature made its way into
vi and thence into some other editors. Typing &#8220;.&#8221; on a line by itself exits
insert mode.</p>

<p>Let&#8217;s try these commands out a bit:</p>

<p>$ ed
% 0a
% Hello, ed tutorial readers!
%
% This is some text in insert mode.
% Insert mode is ended with a &#8220;.&#8221;.
% .
% 1,$n
1 Hello, ed tutorial readers!
2
3 This is some text in insert mode.
4 Insert mode is ended with a &#8220;.&#8221;.
% 3a
% This is a line being appended after line 3.
% .
% 1,$n
1 Hello, ed tutorial readers!
2
3 This is some text in insert mode.
4 This is a line being appended after line 3.
5 Insert mode is ended with a &#8220;.&#8221;.</p>

<p>Here we can see some examples of what adding text to a file is like. If we
had run ed with a filename, it would have loaded that file into its
initial buffer.</p>

<h1>Editing Existing Text</h1>

<p>There&#8217;s a couple more things we&#8217;re going to need, though. What if we make a
mistake? Within a line, we can backspace and type new text, but already- typed
lines need something else to edit them. Enter the d and s commands!</p>

<ul>
<li>d: takes two addresses. Deletes the addressed lines.</li>
<li>s/re/text/[g]: takes two addresses. Within the addressed lines, replaces
/re/ with text. If the g flag is added at the end, replaces all instances in
the addressed lines; otherwise, replaces the first.</li>
</ul>

<p>Let&#8217;s play with the new toys a bit:
$ ed
% 0a
% This is another example.
% Oh, this line was a mistake!
% And this line has a tyop.
% .
% 1,$n
1 This is another example.
2 Oh, this line was a mistake!
3 And this line has a tyop.
% 2d
% 1,$n
1 This is another example.
2 And this line has a tyop.
% 2s/tyop/typo/
% 1,$n
1 This is another example.
2 And this line has a typo.</p>

<p>So here we can see how to delete whole lines and change individual parts of
lines. We can also use the s command for other things, using the ability to
address many lines:</p>

<p>$ ed
% 0a
% This is the first line.
% This is the second line.
% Is this the third line?
% .
% 1,$n
1 This is the first line.
2 This is the second line.
3 Is this the third line?
% 1,$s/^/-&gt; /
% 1,<span class="math">\(s/\)</span>/ &lt;-/
% 1,$n
1 -&gt; This is the first line. &lt;-
2 -&gt; This is the second line. &lt;-
3 -&gt; Is this the third line? &lt;-</p>

<p>Here we&#8217;re making good use of the two-address form of &#8220;s&#8221;, using &#8220;1,<span class="math">\(&quot; to mean
&quot;the first line to the last line&quot; - i.e., the whole buffer. In fact, addressing
the whole buffer is so common that there's a special address for it: &quot;%&quot; is a
shortcut for &quot;1,\)</span>&#8221;.</p>

<h1>Loading and saving</h1>

<p>So we&#8217;ve written some text in our buffer, but how do we actually save it?
Enter the &#8220;w&#8221; command. The w command takes two addresses,
but if no addresses are given it defaults to &#8220;1,$&#8221;. It also takes a
filename after the command, which is where the addressed lines are written
to. If ed was started with a filename, &#8220;w&#8221; will default to
writing to that filename if no filename is given with the command. It has
a counterpart command, &#8220;r&#8221;, which takes one address and
reads the named file after the addressed line. Let&#8217;s play with that:</p>

<p>$ ed
% 0a
% This is the first line.
% This is the second one. It will look pretty in a file!
% This is the third line.
% .
% 2,$w example.txt
79
% 3r example.txt
79
% 1,$n
1 This is the first line.
2 This is the second one. It will look pretty in a file!
3 This is the third line.
4 This is the second one. It will look pretty in a file!
5 This is the third line.</p>

<p>Note that after ed reads or writes a file, it says how many bytes it read or
wrote.</p>

<h1>Quitting</h1>

<p>The last thing we need to learn how to do is quit! The &#8220;q&#8221; command quits ed,
although it will error once if you have a buffer that hasn&#8217;t been written - in
that situation, running &#8220;q&#8221; again will quit ed anyway. Since writing to an
edited file and quitting is a very common operation, some eds have a shortcut
command &#8220;wq&#8221; that writes and quits.</p>

<p>So, let&#8217;s review:</p>

<h1>Quick Reference</h1>

<p>Addressing:</p>

<ul>
<li>1,5: lines numbered 1 to 5, 0 is &#8220;before the first line&#8221;</li>
<li>.: the current line</li>
<li>$: the last line</li>
<li>/re/: the next line matching /re/</li>
</ul>

<p>Commands (address counts prefixed):</p>

<ul>
<li>1a: appends after the addressed line</li>
<li>1i: inserts before the addressed line</li>
<li>2n: prints the addressed lines with numbers</li>
<li>2d: deletes the addressed lines</li>
<li>2s/r/e/[g]: replaces /r/ with e in addressed lines</li>
<li>2w filename: writes the addressed lines to file</li>
<li>1r filename: reads file after addressed line</li>
<li>0q: quits ed, fails once if there are unwritten edits</li>
</ul>

<p>Common idioms:</p>

<ul>
<li>1,$n: print the entire buffer with line numbers</li>
<li>/foo/n: print the next line containing foo</li>
<li>g/foo/p: print all lines containing foo</li>
<li>7d: delete line 7</li>
</ul>

</body>

<footer>
<p><a href="https://twitter.com/NeoYokel">Twitter</a> - <a href="https://mastodon.social/@DavidBlue">Mastodon</a> - <a href="https://t.me/davidblue">Telegram</a> - <a href="drafts://open?uuid=CB95BFAC-E929-4187-8704-7D420685D757">Local</a></p>
</footer>
</html>